<div class="container my-4">
  <mat-card>
    <mat-card-header class="mb-3">
      <mat-card-title> Register </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <table class="w-100 container" cellspacing="0">
          <!-- TODO - nie do konca responsywna tabela -->
          <tr>
            <td>
              <mat-form-field class="w-100">
                <mat-label>First name</mat-label>
                <input matInput formControlName="firstName" />
                @if (registerForm.get("email")?.hasError("required")) {
                <mat-error>First name is required</mat-error>
                }
              </mat-form-field>
            </td>
            <td>
              <mat-form-field class="w-100">
                <mat-label>Last name</mat-label>
                <input matInput formControlName="lastName" />
                @if (registerForm.get("email")?.hasError("required")) {
                <mat-error>Last name is required</mat-error>
                }
              </mat-form-field>
            </td>
          </tr>
        </table>
        <div>
          <mat-form-field class="w-100">
            <mat-label>Email</mat-label>
            <input
              matInput
              type="email"
              formControlName="email"
              placeholder="Your email here..."
              required
            />
            @if (registerForm.get("email")?.hasError("required")) {
            <mat-error>Email is required</mat-error>
            } @if (registerForm.get("email")?.hasError("email")) {
            <mat-error>Enter a valid email</mat-error>
            }
          </mat-form-field>
        </div>
        <div>
          <mat-form-field class="w-100">
            <mat-label>Password</mat-label>
            <input
              matInput
              type="password"
              formControlName="password"
              placeholder="Your password here..."
              required
            />
            @if (registerForm.get("password")?.hasError("required")) {
            <mat-error>Password is required</mat-error>
            }
          </mat-form-field>
        </div>
        <div>
          <mat-form-field class="w-100">
            <mat-label>Date of Birth</mat-label>
            <input
              matInput
              formControlName="dateOfBirth"
              [matDatepicker]="picker"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            @if (registerForm.get("dateOfBirth")?.hasError("required")) {
            <mat-error>Date of birth is required</mat-error>
            } @if (registerForm.get("dateOfBirth")?.hasError("invalidDate")) {
            <mat-error> Date cannot be in the future. </mat-error>
            }
          </mat-form-field>
        </div>
        <div>
          <mat-form-field class="w-100">
            <mat-label>Phone number</mat-label>
            <span matTextPrefix>+48 &nbsp;</span>
            <input
              type="tel"
              matInput
              formControlName="phoneNumber"
              required
              placeholder="555-555-1234"
            />
            @if (registerForm.get("phoneNumber")?.hasError("required")) {
            <mat-error>Phone number is required</mat-error>
            } @if
            (registerForm.get("phoneNumber")?.hasError("invalidPhoneNumber")) {
            <mat-error
              >Invalid phone number format. It should contain exactly 9
              digits.</mat-error
            >
            }
          </mat-form-field>
        </div>
        <mat-expansion-panel class="my-2 mb-3">
          <mat-expansion-panel-header>
            <mat-panel-title> Address (Optional) </mat-panel-title>
          </mat-expansion-panel-header>
          <div formArrayName="address">
            <div [formGroupName]="0">
              <div class="form-group">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>City</mat-label>
                  <input matInput type="text" formControlName="city" />
                </mat-form-field>
              </div>
              <div class="form-group">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Zipcode</mat-label>
                  <input matInput type="text" formControlName="zipcode" />
                </mat-form-field>
              </div>
              <div class="form-group">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>House Number</mat-label>
                  <input matInput type="text" formControlName="houseNumber" />
                </mat-form-field>
              </div>
              <div class="form-group">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Street</mat-label>
                  <input matInput formControlName="street" />
                </mat-form-field>
              </div>
            </div>
          </div>
        </mat-expansion-panel>
        <div class="d-grid gap-2">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="registerForm.invalid"
          >
            Register
          </button>
        </div>
      </form>
      <div class="text-center">
        <a routerLink="/login" class="btn btn-link">
          Already have an account? Login here
        </a>
      </div>
    </mat-card-content>
  </mat-card>
</div>
